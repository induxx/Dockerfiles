#!/bin/bash

LOCAL=$(pwd)
LOCAL=$LOCAL"/$(dirname "$0")"

source "${LOCAL}/.env"

podman pod create --name="ak4-pod" --publish=8080:80

podman run -d \
    --pod="ak4-pod" \
    --name="app" \
    induxx/cloud-akeneo:ak4

podman run -d \
    --pod="ak4-pod" \
    --name="mysql" \
    -e MYSQL_ROOT_PASSWORD='root' -e MYSQL_USER="${APP_DATABASE_USER}" -e MYSQL_DATABASE="${APP_DATABASE_NAME}" -e MYSQL_PASSWORD="${APP_DATABASE_PASSWORD}" \
    docker.io/library/mysql:latest --default-authentication-plugin=mysql_native_password 

podman run -d \
     --pod="ak4-pod" \
     --name="elasticsearch" \
     -e ES_JAVA_OPTS="-Xms512m -Xmx512m" -e discovery.type='single-node' -e xpack.security.enabled="false" \
     docker.io/library/elasticsearch:7.5.1